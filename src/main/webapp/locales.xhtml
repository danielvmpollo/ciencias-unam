<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core" 
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui">
    <h:head>  
        <script type="text/javascript" 
                src="http://maps.googleapis.com/maps/api/js"
                />
        <script type="text/javascript"> 
            var marker = null;
            function agregaMarcador(event) {
               if(window.marker!==null){
                   marker.setMap(null);
               }
                var punto=new google.maps.LatLng(
                        event.latLng.lat(), 
                event.latLng.lng()
                        );
                window.marker = new google.maps.Marker({
                        position:punto,
                        title:'Lugar'
                    });
                    
                    PF('map').addOverlay(marker);
            };
        </script>
        
    </h:head>
    <h:body>	
    	<h4>Alta local</h4>
        
        <h:form id="form">
            <p:outputLabel value="Nombre local" />
            <p:inputText id="nombre" value="#{localController.local.nombre}" required="true" />
            <p:message for="nombre" />
            <br/>
            <p:outputLabel value="Categoria" />
            <p:inputText id="categoria" value="#{localController.local.categoria}" required="true" />
            <p:message for="categoria" />
            <br/>
            <p:outputLabel value="Ubicacion" />
             <p:gmap id="gmap" center="19.3142052,-99.1835216" zoom="13" 
                    type="HYBRID" 
                    style="width:600px;height:400px"
                    onPointClick="agregaMarcador(event);"
                    widgetVar="map"
                    disableDoubleClickZoom="true"      
                    >
                    
                    
                 <p:ajax event="pointSelect" listener="#{localController.seleccion}"  update=":form:cords"   />
            </p:gmap>
            <h:panelGrid id="cords">
                <p:outputLabel value="Latitud: #{localController.local.latitud}" />
                <p:outputLabel value="Longitud: #{localController.local.longitud}" />
                </h:panelGrid>
            <br/>
            <p:commandButton 
                actionListener="#{localController.guardarLocal()}" 
                             value="Guardar" />
        </h:form>
        
    </h:body>
</html>